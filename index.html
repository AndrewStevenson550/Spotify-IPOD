<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iSpotify Player</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use Inter font, which is similar to the iPod's font */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Create the inner shadow for the click wheel */
        .click-wheel-inset {
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }
        /* Create the subtle gradient for the center button */
        .select-button-gradient {
            background-image: linear-gradient(to bottom, #e0e0e0, #c0c0c0);
        }
        .select-button-gradient:active {
            background-image: linear-gradient(to top, #e0e0e0, #c0c0c0);
        }
    </style>
</head>
<body class="bg-gray-900 flex items-center justify-center min-h-screen font-sans">

    <!-- LOGIN BUTTON - We'll put this outside the iPod for now -->
    <button id="btn-login" class="absolute top-4 right-4 bg-green-500 text-white font-bold py-2 px-4 rounded-full shadow-lg hover:bg-green-600 transition-colors">
        Login with Spotify
    </button>

    <!-- iPod Body -->
    <div class="w-72 h-[520px] bg-gradient-to-b from-gray-200 to-gray-300 rounded-3xl shadow-2xl p-4 flex flex-col gap-4 border-2 border-gray-400">

        <!-- Screen Container -->
        <div class="h-2/5 bg-gray-800 rounded-lg p-1 border-2 border-gray-900">
            <div class="bg-blue-100 w-full h-full rounded flex flex-col overflow-hidden">
                
                <!-- Screen Header -->
                <div class="flex justify-between items-center px-3 py-1 bg-gray-300 border-b border-gray-400">
                    <span class="font-bold text-sm text-gray-800">iSpotify</span>
                    <!-- Battery Icon -->
                    <svg class="w-5 h-5 text-gray-800" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor">
                        <path d="M18.364 5.636a9 9 0 11-12.728 0M12 2v10"></path>
                        <path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3.19M15 6h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-3.19"></path>
                    </svg>
                </div>

                <!-- Screen Content -->
                <div class="flex-grow relative">
                    
                    <!-- Menu View -->
                    <div id="menu-view" class="absolute inset-0">
                        <ul id="menu-list" class="list-none m-0 p-0 text-gray-900">
                            <li class="px-3 py-1.5 font-semibold text-sm border-b border-gray-300" data-view="now-playing">
                                Now Playing
                            </li>
                            <li class="px-3 py-1.5 font-semibold text-sm border-b border-gray-300" data-view="playlists">
                                Playlists
                            </li>
                            <li class="px-3 py-1.5 font-semibold text-sm border-b border-gray-300" data-view="search">
                                Search
                            </li>
                            <li class="px-3 py-1.5 font-semibold text-sm" data-view="settings">
                                Settings
                            </li>
                        </ul>
                    </div>

                    <!-- Now Playing View -->
                    <div id="now-playing-view" class="absolute inset-0 p-3 flex flex-col items-center justify-start hidden">
                        <!-- Placeholder for Album Art -->
                        <div class="w-28 h-28 bg-gray-400 rounded-md shadow-md flex items-center justify-center text-gray-600 mt-2">
                            <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2zm12-3c-1.105 0-2 .895-2 2s.895 2 2 2 2-.895 2-2-.895-2-2-2z"></path></svg>
                        </div>
                        <h2 id="song-title" class="text-lg font-bold text-gray-900 mt-3 text-center truncate w-full">Song Title</h2>
                        <p id="song-artist" class="text-sm text-gray-700 text-center truncate w-full">Artist Name</p>
                        <p id="song-album" class="text-xs text-gray-600 text-center truncate w-full">Album</p>
                        
                        <!-- Scrub Bar -->
                        <div class="w-full h-1.5 bg-gray-400 rounded-full mt-4">
                            <div class="w-1/3 h-full bg-blue-500 rounded-full"></div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Click Wheel Container -->
        <div class="h-3/5 flex-grow flex items-center justify-center">
            <div class="w-48 h-48 bg-gray-300 rounded-full relative shadow-inner click-wheel-inset border-2 border-gray-400">
                
                <!-- Buttons -->
                <button id="btn-menu" class="absolute top-3 left-1/2 -translate-x-1/2 text-gray-700 font-bold text-sm tracking-wider z-10">MENU</button>
                
                <button id="btn-prev" class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-700 z-10 p-2 rounded-full active:bg-gray-400">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.445 14.832A1 1 0 0010 14.226V5.774a1 1 0 00-1.555-.832L4 8.674V5.774a1 1 0 00-2 0v8.452a1 1 0 002 0v-2.9l4.445 3.5z"></path></svg>
                </button>
                
                <button id="btn-next" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-700 z-10 p-2 rounded-full active:bg-gray-400">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.555 5.168A1 1 0 0010 5.774v8.452a1 1 0 001.555.832L16 11.326v2.9a1 1 0 002 0V5.774a1 1 0 00-2 0v2.9l-4.445-3.5z"></path></svg>
                </button>
                
                <button id="btn-play" class="absolute bottom-3 left-1/2 -translate-x-1/2 text-gray-700 z-10 p-2 rounded-full active:bg-gray-400">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.006v3.988a1 1 0 001.555.832l3.198-1.994a1 1 0 000-1.664l-3.198-1.994z" clip-rule="evenodd"></path></svg>
                </button>

                <!-- Center Select Button -->
                <div id="btn-select" class="absolute w-16 h-16 bg-gray-400 rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-md border-2 border-gray-500 cursor-pointer select-button-gradient">
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Spotify API ---
            // 1. Add your Client ID from the Spotify Dashboard
            //    (It's safe to have this in the front-end)
            const CLIENT_ID = "cc3e477403484a58a4673502ef0a9a70"; // This is from your screenshot
            const REDIRECT_URI = "http://127.0.0.1:5500/callback.html"; // Must match Spotify Dashboard!

            // 2. Define the 'scopes' - what we want to ask permission for
            const scopes = [
                "user-read-currently-playing", // Read what's currently playing
                "user-modify-playback-state",  // Play, pause, skip
                "playlist-read-private",       // Read private playlists
                "playlist-read-collaborative"  // Read collaborative playlists
            ].join(" "); // Join them with a space

            // 3. Login Button Click
            document.getElementById('btn-login').addEventListener('click', () => {
                // Generate a random string for 'state' (helps with security)
                const state = Array.from({ length: 16 }, () => Math.random().toString(36)[2]).join('');
                // We'll store this in the browser to check it later
                localStorage.setItem('spotify_auth_state', state);

                // Build the URL to send the user to Spotify's login
                let authUrl = "https://accounts.spotify.com/authorize";
                authUrl += "?response_type=code";
                authUrl += "&client_id=" + CLIENT_ID;
                authUrl += "&scope=" + encodeURIComponent(scopes);
                authUrl += "&redirect_uri=" + encodeURIComponent(REDIRECT_URI);
                authUrl += "&state=" + encodeURIComponent(state);

                // Send the user to the login page!
                window.location.href = authUrl;
            });


            // --- iPod UI ---
            let currentView = 'menu';
            let selectedMenuItem = 0;

            const menuList = document.getElementById('menu-list');
            const menuItems = menuList.querySelectorAll('li');
            
            const views = {
                'menu': document.getElementById('menu-view'),
                'now-playing': document.getElementById('now-playing-view'),
                'playlists': null, // Placeholder
                'search': null,    // Placeholder
                'settings': null,  // Placeholder
            };

            // --- Helper Functions ---

            function updateMenuUI() {
                // Remove 'active' class from all items
                menuItems.forEach(item => {
                    item.classList.remove('bg-blue-500', 'text-white');
                });
                // Add 'active' class to the selected item
                menuItems[selectedMenuItem].classList.add('bg-blue-500', 'text-white');
            }

            function setView(viewName) {
                // Hide all views
                Object.values(views).forEach(view => {
                    if (view) view.classList.add('hidden');
                });

                // Show the selected view
                if (views[viewName]) {
                    views[viewName].classList.remove('hidden');
                    currentView = viewName;
                } else {
                    // Fallback to menu if view doesn't exist
                    views['menu'].classList.remove('hidden');
                    currentView = 'menu';
                }
            }

            // --- Event Listeners ---

            // Scroll Down (Next Button)
            document.getElementById('btn-next').addEventListener('click', () => {
                if (currentView === 'menu') {
                    selectedMenuItem++;
                    if (selectedMenuItem >= menuItems.length) {
                        selectedMenuItem = 0; // Wrap around
                    }
                    updateMenuUI();
                } else {
                    // Future: Skip to next track
                    console.log('Next Track');
                }
            });

            // Scroll Up (Previous Button)
            document.getElementById('btn-prev').addEventListener('click', () => {
                if (currentView === 'menu') {
                    selectedMenuItem--;
                    if (selectedMenuItem < 0) {
                        selectedMenuItem = menuItems.length - 1; // Wrap around
                    }
                    updateMenuUI();
                } else {
                    // Future: Previous track
                    console.log('Previous Track');
                }
            });

            // Menu Button
            document.getElementById('btn-menu').addEventListener('click', () => {
                setView('menu');
            });

            // Select Button
            document.getElementById('btn-select').addEventListener('click', () => {
                if (currentView === 'menu') {
                    const selectedItem = menuItems[selectedMenuItem];
                    const viewToOpen = selectedItem.dataset.view;
                    
                    if (viewToOpen) {
                        setView(viewToOpen);
                    } else {
                        console.log('This menu item is not implemented.');
                    }
                }
            });

            // Play/Pause Button
            document.getElementById('btn-play').addEventListener('click', () => {
                // Future: Control Spotify playback
                console.log('Play/Pause Toggled');
                // For demonstration, you could toggle the Now Playing view
                if (currentView !== 'now-playing') {
                    setView('now-playing');
                }
            });


            // --- Initial Setup ---
            updateMenuUI();
            setView('menu');

        });
    </script>
</body>
</html>
